"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["5704"],{1439:function(e,t,r){r.r(t),r.d(t,{default:()=>d,frontMatter:()=>s,metadata:()=>i,assets:()=>c,toc:()=>l,contentTitle:()=>o});var i=JSON.parse('{"id":"rtk-query/usage/usage-without-react-hooks","title":"Usage Without React Hooks","description":"RTK Query > Usage > Usage Without React Hooks: Using RTKQ with other UI frameworks","source":"@site/../docs/rtk-query/usage/usage-without-react-hooks.mdx","sourceDirName":"rtk-query/usage","slug":"/rtk-query/usage/usage-without-react-hooks","permalink":"/rtk-query/usage/usage-without-react-hooks","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1747273418000,"frontMatter":{"id":"usage-without-react-hooks","title":"Usage Without React Hooks","sidebar_label":"Usage Without React Hooks","hide_title":true,"description":"RTK Query > Usage > Usage Without React Hooks: Using RTKQ with other UI frameworks"},"sidebar":"docs","previous":{"title":"Persistence and Rehydration","permalink":"/rtk-query/usage/persistence-and-rehydration"},"next":{"title":"Customizing createApi","permalink":"/rtk-query/usage/customizing-create-api"}}'),n=r("4246"),a=r("980");r("8049"),r("5181");let s={id:"usage-without-react-hooks",title:"Usage Without React Hooks",sidebar_label:"Usage Without React Hooks",hide_title:!0,description:"RTK Query > Usage > Usage Without React Hooks: Using RTKQ with other UI frameworks"},o="Usage Without React Hooks",c={},l=[{value:"Adding a subscription",id:"adding-a-subscription",level:2},{value:"Removing a subscription",id:"removing-a-subscription",level:2},{value:"Accessing cached data &amp; request status",id:"accessing-cached-data--request-status",level:2},{value:"Memoization",id:"memoization",level:3},{value:"Performing mutations",id:"performing-mutations",level:2},{value:"Examples",id:"examples",level:2},{value:"Further Information",id:"further-information",level:2}];function u(e){let t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"\xa0"}),"\n",(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"usage-without-react-hooks",children:"Usage Without React Hooks"})}),"\n",(0,n.jsxs)(t.p,{children:["Like the Redux core and Redux Toolkit, RTK Query's primary functionality is UI-agnostic and can be used with any UI layer. RTK Query also includes a version of ",(0,n.jsx)(t.a,{href:"/rtk-query/api/createApi",children:(0,n.jsx)(t.code,{children:"createApi"})})," designed specifically for use with React, which ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks",children:"automatically generates React hooks"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"While React hooks are the primary way that the majority of users are expected to be using RTK Query, the library itself uses plain JS logic and can be used both with React Class components, and independent of React itself."}),"\n",(0,n.jsxs)(t.p,{children:["This page documents how to interact with RTK Query when used without React Hooks, in order to make proper use of RTK Query ",(0,n.jsx)(t.a,{href:"./cache-behavior",children:(0,n.jsx)(t.code,{children:"cache behavior"})}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"adding-a-subscription",children:"Adding a subscription"}),"\n",(0,n.jsxs)(t.p,{children:["Cache subscriptions are used to tell RTK Query that it needs to fetch data for an endpoint. A subscription for an endpoint can be added by dispatching the result of the ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/endpoints#initiate",children:(0,n.jsx)(t.code,{children:"initiate"})})," thunk action creator attached to a query endpoint."]}),"\n",(0,n.jsxs)(t.p,{children:["With React hooks, this behavior is instead handled within ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#usequery",children:(0,n.jsx)(t.code,{children:"useQuery"})}),", ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#usequerysubscription",children:(0,n.jsx)(t.code,{children:"useQuerySubscription"})}),", ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#uselazyquery",children:(0,n.jsx)(t.code,{children:"useLazyQuery"})}),", and ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#uselazyquerysubscription",children:(0,n.jsx)(t.code,{children:"useLazyQuerySubscription"})}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="Subscribing to cached data" no-transpile',children:"const promise = dispatch(api.endpoints.getPosts.initiate())\nconst { refetch } = promise\n// interact with the cache in the same way as you would with a useFetch...() hook\nconst { data, isLoading, isSuccess /*...*/ } = await promise\n"})}),"\n",(0,n.jsx)(t.h2,{id:"removing-a-subscription",children:"Removing a subscription"}),"\n",(0,n.jsx)(t.p,{children:"Removing a cache subscription is necessary for RTK Query to identify that cached data is no longer required. This allows RTK Query to clean up and remove old cache data."}),"\n",(0,n.jsxs)(t.p,{children:["The result of dispatching the ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/endpoints#initiate",children:(0,n.jsx)(t.code,{children:"initiate"})})," thunk action creator of a query endpoint is a Promise with an ",(0,n.jsx)(t.code,{children:"unsubscribe"})," property. This property is a function that when called, will remove the corresponding cache subscription."]}),"\n",(0,n.jsxs)(t.p,{children:["With React hooks, this behavior is instead handled within ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#usequery",children:(0,n.jsx)(t.code,{children:"useQuery"})}),", ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#usequerysubscription",children:(0,n.jsx)(t.code,{children:"useQuerySubscription"})}),", ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#uselazyquery",children:(0,n.jsx)(t.code,{children:"useLazyQuery"})}),", and ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#uselazyquerysubscription",children:(0,n.jsx)(t.code,{children:"useLazyQuerySubscription"})}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="Unsubscribing from cached data" no-transpile',children:"// Adding a cache subscription\nconst promise = dispatch(api.endpoints.getPosts.initiate())\n\n// Removing the corresponding cache subscription\npromise.unsubscribe()\n"})}),"\n",(0,n.jsx)(t.h2,{id:"accessing-cached-data--request-status",children:"Accessing cached data & request status"}),"\n",(0,n.jsxs)(t.p,{children:["Accessing cache data and request status information can be performed using the ",(0,n.jsx)(t.code,{children:"select"})," function property of a query endpoint to create a selector and call that with the Redux state. This provides a snapshot of the cache data and request status information at the time it is called."]}),"\n",(0,n.jsx)(t.admonition,{type:"caution",children:(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"endpoint.select(arg)"})," function creates a ",(0,n.jsx)(t.em,{children:"new"})," selector instance - it isn't the actual selector function itself!"]})}),"\n",(0,n.jsxs)(t.p,{children:["With React hooks, this behavior is instead handled within ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#usequery",children:(0,n.jsx)(t.code,{children:"useQuery"})}),", ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#usequerystate",children:(0,n.jsx)(t.code,{children:"useQueryState"})}),", and ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#uselazyquery",children:(0,n.jsx)(t.code,{children:"useLazyQuery"})}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="Accessing cached data & request status" no-transpile',children:"const result = api.endpoints.getPosts.select()(state)\nconst { data, isSuccess, isError, error } = result\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Note that unlike with the auto-generated hooks, there is no ",(0,n.jsx)(t.code,{children:"isFetching"})," flag, and the ",(0,n.jsx)(t.code,{children:"isLoading"})," flag will be true if the status is pending, regardless of if there is already data."]}),"\n",(0,n.jsx)(t.h3,{id:"memoization",children:"Memoization"}),"\n",(0,n.jsxs)(t.p,{children:["Because the ",(0,n.jsx)(t.code,{children:"endpoint.select(arg)"})," function returns a new selector each time it's called, and because this instance itself is memoized, it can be desirable to memoize the creation of a selector (for example, to then use that memoized instance in another selector). This can be done with ",(0,n.jsx)(t.code,{children:"createSelector"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="Creating a memoized selector creator" no-transpile',children:"const createGetPostSelector = createSelector(\n  (id: string) => id,\n  (id) => api.endpoints.getPost.select(id),\n)\n\nconst selectGetPostError = createSelector(\n  (state: RootState) => state,\n  (state: RootState, id: string) => createGetPostSelector(id),\n  (state, selectGetPost) => selectGetPost(state).error,\n)\n"})}),"\n",(0,n.jsx)(t.h2,{id:"performing-mutations",children:"Performing mutations"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"/rtk-query/usage/mutations",children:"Mutations"})," are used in order to update data on the server. Mutations can be performed by dispatching the result of the ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/endpoints#initiate",children:(0,n.jsx)(t.code,{children:"initiate"})})," thunk action creator attached to a mutation endpoint."]}),"\n",(0,n.jsxs)(t.p,{children:["With React hooks, this behavior is instead handled within ",(0,n.jsx)(t.a,{href:"/rtk-query/api/created-api/hooks#usemutation",children:(0,n.jsx)(t.code,{children:"useMutation"})}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="Triggering a mutation endpoint" no-transpile',children:"dispatch(api.endpoints.addPost.initiate({ name: 'foo' }))\n"})}),"\n",(0,n.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsx)(t.p,{children:"Examples of usage without React hooks can be found under the following:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"PostDetail"})," component in the ",(0,n.jsxs)(t.a,{href:"/rtk-query/usage/examples#react-class-components",children:[(0,n.jsx)(t.code,{children:"React Class Components"})," example"]})]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsxs)(t.a,{href:"/rtk-query/usage/examples#svelte",children:[(0,n.jsx)(t.code,{children:"Svelte"})," example"]})]}),"\n",(0,n.jsxs)(t.li,{children:["The below ",(0,n.jsx)(t.code,{children:"Cache Lifetime Subscription Class Component"})," example:"]}),"\n"]}),"\n",(0,n.jsx)("iframe",{src:"https://codesandbox.io/embed/rtk-query-cache-lifetime-subscription-class-component-example-38mgd?fontsize=12&runonclick=1&hidenavigation=1&module=%2Fsrc%2Fcomponents%2FUsersList.tsx&theme=dark&runonclick=1",style:{width:"100%",height:"800px",border:0,borderRadius:"4px",overflow:"hidden"},title:"RTK Query Cache Lietime Subscription Class Component Example",allow:"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb",sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin"}),"\n",(0,n.jsx)(t.h2,{id:"further-information",children:"Further Information"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["NgRx maintainer Brandon Roberts has written a post called ",(0,n.jsx)(t.a,{href:"https://dev.to/brandontroberts/cousins-playing-nicely-experimenting-with-ngrx-store-and-rtk-query-25f4",children:"Cousins playing nicely: Experimenting with NgRx Store and RTK Query"}),", which demonstrates some approaches for integrating RTK Query into NgRx"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/SaulMoro/ngrx-rtk-query",children:(0,n.jsx)(t.code,{children:"saulmoro/ngrx-rtk-query"})})," implements an NgRx equivalent of the subscription lifecycle managed in RTKQ's own React hooks"]}),"\n"]})]})}function d(e={}){let{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},8049:function(e,t,r){r.d(t,{Z:()=>a});var i=r("4246");r("7378");var n=r("4870");function a(e){let{children:t,hidden:r,className:a}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,n.Z)("tabItem_wHwb",a),hidden:r,children:t})}},5181:function(e,t,r){r.d(t,{Z:()=>y});var i=r("4246"),n=r("7378"),a=r("4870"),s=r("5403"),o=r("3620"),c=r("7090"),l=r("6180"),u=r("3418"),d=r("9073");function h(e){var t,r;return null!==(r=null===(t=n.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){let{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw Error("Docusaurus error: Bad <Tabs> child <".concat("string"==typeof e.type?e.type:e.type.name,'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.'))}))||void 0===t?void 0:t.filter(Boolean))&&void 0!==r?r:[]}function p(e){let{value:t,tabValues:r}=e;return r.some(e=>e.value===t)}var m=r("3344");function f(e){let{className:t,block:r,selectedValue:n,selectValue:o,tabValues:c}=e,l=[],{blockElementScrollPositionUntilNextRender:u}=(0,s.o5)(),d=e=>{let t=e.currentTarget,r=c[l.indexOf(t)].value;r!==n&&(u(t),o(r))},h=e=>{var t,r;let i=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{let r=l.indexOf(e.currentTarget)+1;i=null!==(t=l[r])&&void 0!==t?t:l[0];break}case"ArrowLeft":{let t=l.indexOf(e.currentTarget)-1;i=null!==(r=l[t])&&void 0!==r?r:l[l.length-1]}}null==i||i.focus()};return(0,i.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":r},t),children:c.map(e=>{let{value:t,label:r,attributes:s}=e;return(0,i.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>l.push(e),onKeyDown:h,onClick:d,...s,className:(0,a.Z)("tabs__item","tabItem_l0OV",null==s?void 0:s.className,{"tabs__item--active":n===t}),children:null!=r?r:t},t)})})}function x(e){let{lazy:t,children:r,selectedValue:s}=e,o=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){let e=o.find(e=>e.props.value===s);return e?(0,n.cloneElement)(e,{className:(0,a.Z)("margin-top--md",e.props.className)}):null}return(0,i.jsx)("div",{className:"margin-top--md",children:o.map((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==s}))})}function g(e){let t=function(e){let{defaultValue:t,queryString:r=!1,groupId:i}=e,a=function(e){let{values:t,children:r}=e;return(0,n.useMemo)(()=>{let e=null!=t?t:h(r).map(e=>{let{props:{value:t,label:r,attributes:i,default:n}}=e;return{value:t,label:r,attributes:i,default:n}});return!function(e){let t=(0,u.lx)(e,(e,t)=>e.value===t.value);if(t.length>0)throw Error('Docusaurus error: Duplicate values "'.concat(t.map(e=>e.value).join(", "),'" found in <Tabs>. Every value needs to be unique.'))}(e),e},[t,r])}(e),[s,m]=(0,n.useState)(()=>(function(e){var t;let{defaultValue:r,tabValues:i}=e;if(0===i.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!p({value:r,tabValues:i}))throw Error('Docusaurus error: The <Tabs> has a defaultValue "'.concat(r,'" but none of its children has the corresponding value. Available values are: ').concat(i.map(e=>e.value).join(", "),". If you intend to show no default tab, use defaultValue={null} instead."));return r}let n=null!==(t=i.find(e=>e.default))&&void 0!==t?t:i[0];if(!n)throw Error("Unexpected error: 0 tabValues");return n.value})({defaultValue:t,tabValues:a})),[f,x]=function(e){let{queryString:t=!1,groupId:r}=e,i=(0,o.k6)(),a=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=r?r:null}({queryString:t,groupId:r});return[(0,l._X)(a),(0,n.useCallback)(e=>{if(!a)return;let t=new URLSearchParams(i.location.search);t.set(a,e),i.replace({...i.location,search:t.toString()})},[a,i])]}({queryString:r,groupId:i}),[g,y]=function(e){let{groupId:t}=e,r=t?"docusaurus.tab.".concat(t):null,[i,a]=(0,d.Nk)(r);return[i,(0,n.useCallback)(e=>{r&&a.set(e)},[r,a])]}({groupId:i}),b=(()=>{let e=null!=f?f:g;return p({value:e,tabValues:a})?e:null})();return(0,c.Z)(()=>{b&&m(b)},[b]),{selectedValue:s,selectValue:(0,n.useCallback)(e=>{if(!p({value:e,tabValues:a}))throw Error("Can't select invalid tab value=".concat(e));m(e),x(e),y(e)},[x,y,a]),tabValues:a}}(e);return(0,i.jsxs)("div",{className:(0,a.Z)("tabs-container","tabList_J5MA"),children:[(0,i.jsx)(f,{...t,...e}),(0,i.jsx)(x,{...t,...e})]})}function y(e){let t=(0,m.Z)();return(0,i.jsx)(g,{...e,children:h(e.children)},String(t))}},980:function(e,t,r){r.d(t,{Z:function(){return o},a:function(){return s}});var i=r(7378);let n={},a=i.createContext(n);function s(e){let t=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);