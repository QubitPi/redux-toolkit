"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1866],{3519:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return p}});var n=a(2685),r=a(1244),i=(a(7378),a(5318)),o=["components"],s={id:"overview",title:"RTK Query Overview",sidebar_label:"RTK Query Overview",hide_title:!0,description:"RTK Query > Overview: a summary of the RTK Query data caching API for Redux Toolkit"},l=void 0,u={unversionedId:"rtk-query/overview",id:"rtk-query/overview",title:"RTK Query Overview",description:"RTK Query > Overview: a summary of the RTK Query data caching API for Redux Toolkit",source:"@site/../docs/rtk-query/overview.md",sourceDirName:"rtk-query",slug:"/rtk-query/overview",permalink:"/rtk-query/overview",draft:!1,tags:[],version:"current",lastUpdatedAt:1716193556,formattedLastUpdatedAt:"May 20, 2024",frontMatter:{id:"overview",title:"RTK Query Overview",sidebar_label:"RTK Query Overview",hide_title:!0,description:"RTK Query > Overview: a summary of the RTK Query data caching API for Redux Toolkit"},sidebar:"docs",previous:{title:"Codemods",permalink:"/api/codemods"},next:{title:"Comparison with Other Tools",permalink:"/rtk-query/comparison"}},d={},p=[{value:"Motivation",id:"motivation",level:2},{value:"What&#39;s included",id:"whats-included",level:2},{value:"APIs",id:"apis",level:3},{value:"Bundle Size",id:"bundle-size",level:3},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Create an API Slice",id:"create-an-api-slice",level:3},{value:"Configure the Store",id:"configure-the-store",level:3},{value:"Use Hooks in Components",id:"use-hooks-in-components",level:3},{value:"Further Information",id:"further-information",level:2}],c={toc:p};function h(e){var t=e.components,a=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"rtk-query-overview"},"RTK Query Overview"),(0,i.kt)("admonition",{title:"What You'll Learn",type:"tip"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"What RTK Query is and what problems it solves"),(0,i.kt)("li",{parentName:"ul"},"What APIs are included in RTK Query"),(0,i.kt)("li",{parentName:"ul"},"Basic RTK Query usage"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"RTK Query")," is a powerful data fetching and caching tool. It is designed to simplify common cases for loading data in a web application, ",(0,i.kt)("strong",{parentName:"p"},"eliminating the need to hand-write data fetching & caching logic yourself"),"."),(0,i.kt)("p",null,"RTK Query is ",(0,i.kt)("strong",{parentName:"p"},"an optional addon included in the Redux Toolkit package"),", and its functionality is built on top of the other APIs in Redux Toolkit."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"To learn how to use RTK Query, see the full ",(0,i.kt)("a",{parentName:"p",href:"https://redux.js.org/tutorials/essentials/part-7-rtk-query-basics"},'"Redux Essentials" tutorial')," on the Redux core docs site."),(0,i.kt)("p",{parentName:"admonition"},"If you prefer a video course, you can ",(0,i.kt)("a",{parentName:"p",href:"https://egghead.io/courses/rtk-query-basics-query-endpoints-data-flow-and-typescript-57ea3c43?af=7pnhj6"},"watch this RTK Query video course by Lenz Weber-Tronic, the creator of RTK Query, for free at Egghead")," or take a look at the first lesson right here:"),(0,i.kt)("div",{style:{position:"relative",paddingTop:"56.25%"}},(0,i.kt)("iframe",{src:"https://app.egghead.io/lessons/redux-course-introduction-and-application-walk-through-for-rtk-query-basics/embed?af=7pnhj6",title:"RTK Query Video course at Egghead: Course Introduction and Application Walk through for RTK Query Basics",frameborder:"0",allowfullscreen:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}}))),(0,i.kt)("h2",{id:"motivation"},"Motivation"),(0,i.kt)("p",null,"Web applications normally need to fetch data from a server in order to display it. They also usually need to make updates to that data, send those updates to the server, and keep the cached data on the client in sync with the data on the server. This is made more complicated by the need to implement other behaviors used in today's applications:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Tracking loading state in order to show UI spinners"),(0,i.kt)("li",{parentName:"ul"},"Avoiding duplicate requests for the same data"),(0,i.kt)("li",{parentName:"ul"},"Optimistic updates to make the UI feel faster"),(0,i.kt)("li",{parentName:"ul"},"Managing cache lifetimes as the user interacts with the UI")),(0,i.kt)("p",null,"The Redux core has always been very minimal - it's up to developers to write all the actual logic. That means that Redux has never included anything built in to help solve these use cases. The Redux docs have taught ",(0,i.kt)("a",{parentName:"p",href:"https://redux.js.org/tutorials/fundamentals/part-7-standard-patterns#async-request-status"},"some common patterns for dispatching actions around the request lifecycle to track loading state and request results"),", and ",(0,i.kt)("a",{parentName:"p",href:"/api/createAsyncThunk"},"Redux Toolkit's ",(0,i.kt)("inlineCode",{parentName:"a"},"createAsyncThunk")," API")," was designed to abstract that typical pattern. However, users still have to write significant amounts of reducer logic to manage the loading state and the cached data."),(0,i.kt)("p",null,"Over the last couple years, the React community has come to realize that ",(0,i.kt)("strong",{parentName:"p"},'"data fetching and caching" is really a different set of concerns than "state management"'),". While you can use a state management library like Redux to cache data, the use cases are different enough that it's worth using tools that are purpose-built for the data fetching use case."),(0,i.kt)("p",null,"RTK Query takes inspiration from other tools that have pioneered solutions for data fetching, like Apollo Client, React Query, Urql, and SWR, but adds a unique approach to its API design:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The data fetching and caching logic is built on top of Redux Toolkit's ",(0,i.kt)("inlineCode",{parentName:"li"},"createSlice")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"createAsyncThunk")," APIs"),(0,i.kt)("li",{parentName:"ul"},"Because Redux Toolkit is UI-agnostic, RTK Query's functionality can be used with any UI layer"),(0,i.kt)("li",{parentName:"ul"},"API endpoints are defined ahead of time, including how to generate query parameters from arguments and transform responses for caching"),(0,i.kt)("li",{parentName:"ul"},"RTK Query can also generate React hooks that encapsulate the entire data fetching process, provide ",(0,i.kt)("inlineCode",{parentName:"li"},"data")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"isLoading")," fields to components, and manage the lifetime of cached data as components mount and unmount"),(0,i.kt)("li",{parentName:"ul"},'RTK Query provides "cache entry lifecycle" options that enable use cases like streaming cache updates via websocket messages after fetching the initial data'),(0,i.kt)("li",{parentName:"ul"},"We have early working examples of code generation of API slices from OpenAPI and GraphQL schemas"),(0,i.kt)("li",{parentName:"ul"},"Finally, RTK Query is completely written in TypeScript, and is designed to provide an excellent TS usage experience")),(0,i.kt)("h2",{id:"whats-included"},"What's included"),(0,i.kt)("h3",{id:"apis"},"APIs"),(0,i.kt)("p",null,"RTK Query is included within the installation of the core Redux Toolkit package. It is available via either of the two entry points below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:"no-transpile","no-transpile":!0},"import { createApi } from '@reduxjs/toolkit/query'\n\n/* React-specific entry point that automatically generates\n   hooks corresponding to the defined endpoints */\nimport { createApi } from '@reduxjs/toolkit/query/react'\n")),(0,i.kt)("p",null,"RTK Query includes these APIs:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/rtk-query/api/createApi"},(0,i.kt)("inlineCode",{parentName:"a"},"createApi()")),': The core of RTK Query\'s functionality. It allows you to define a set of "endpoints" that describe how to retrieve data from backend APIs and other async sources, including the configuration of how to fetch and transform that data. In most cases, you should use this once per app, with "one API slice per base URL" as a rule of thumb.'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/rtk-query/api/fetchBaseQuery"},(0,i.kt)("inlineCode",{parentName:"a"},"fetchBaseQuery()")),": A small wrapper around ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API"},(0,i.kt)("inlineCode",{parentName:"a"},"fetch"))," that aims to simplify requests. Intended as the recommended ",(0,i.kt)("inlineCode",{parentName:"li"},"baseQuery")," to be used in ",(0,i.kt)("inlineCode",{parentName:"li"},"createApi")," for the majority of users."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/rtk-query/api/ApiProvider"},(0,i.kt)("inlineCode",{parentName:"a"},"<ApiProvider />")),": Can be used as a ",(0,i.kt)("inlineCode",{parentName:"li"},"Provider")," if you ",(0,i.kt)("strong",{parentName:"li"},"do not already have a Redux store"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/rtk-query/api/setupListeners"},(0,i.kt)("inlineCode",{parentName:"a"},"setupListeners()")),": A utility used to enable ",(0,i.kt)("inlineCode",{parentName:"li"},"refetchOnMount")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"refetchOnReconnect")," behaviors.")),(0,i.kt)("h3",{id:"bundle-size"},"Bundle Size"),(0,i.kt)("p",null,"RTK Query adds a fixed one-time amount to your app's bundle size. Since RTK Query builds on top of Redux Toolkit and React-Redux, the added size varies depending on whether you are already using those in your app. The estimated min+gzip bundle sizes are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If you are using RTK already: ~9kb for RTK Query and ~2kb for the hooks."),(0,i.kt)("li",{parentName:"ul"},"If you are not using RTK already:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Without React: 17 kB for RTK+dependencies+RTK Query"),(0,i.kt)("li",{parentName:"ul"},"With React: 19kB + React-Redux, which is a peer dependency")))),(0,i.kt)("p",null,"Adding additional endpoint definitions should only increase size based on the actual code inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"endpoints")," definitions, which will typically be just a few bytes."),(0,i.kt)("p",null,"The functionality included in RTK Query quickly pays for the added bundle size, and the elimination of hand-written data fetching logic should be a net improvement in size for most meaningful applications."),(0,i.kt)("h2",{id:"basic-usage"},"Basic Usage"),(0,i.kt)("h3",{id:"create-an-api-slice"},"Create an API Slice"),(0,i.kt)("p",null,"RTK Query is included within the installation of the core Redux Toolkit package. It is available via either of the two entry points below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { createApi } from '@reduxjs/toolkit/query'\n\n/* React-specific entry point that automatically generates\n   hooks corresponding to the defined endpoints */\nimport { createApi } from '@reduxjs/toolkit/query/react'\n")),(0,i.kt)("p",null,"For typical usage with React, start by importing ",(0,i.kt)("inlineCode",{parentName:"p"},"createApi"),' and defining an "API slice" that lists the server\'s base URL and which endpoints we want to interact with:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react'\nimport type { Pokemon } from './types'\n\n// Define a service using a base URL and expected endpoints\nexport const pokemonApi = createApi({\n  reducerPath: 'pokemonApi',\n  baseQuery: fetchBaseQuery({ baseUrl: 'https://pokeapi.co/api/v2/' }),\n  endpoints: (builder) => ({\n    getPokemonByName: builder.query<Pokemon, string>({\n      query: (name) => `pokemon/${name}`,\n    }),\n  }),\n})\n\n// Export hooks for usage in functional components, which are\n// auto-generated based on the defined endpoints\nexport const { useGetPokemonByNameQuery } = pokemonApi\n")),(0,i.kt)("h3",{id:"configure-the-store"},"Configure the Store"),(0,i.kt)("p",null,'The "API slice" also contains an auto-generated Redux slice reducer and a custom middleware that manages subscription lifetimes. Both of those need to be added to the Redux store:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { configureStore } from '@reduxjs/toolkit'\n// Or from '@reduxjs/toolkit/query/react'\nimport { setupListeners } from '@reduxjs/toolkit/query'\nimport { pokemonApi } from './services/pokemon'\n\nexport const store = configureStore({\n  reducer: {\n    // Add the generated reducer as a specific top-level slice\n    [pokemonApi.reducerPath]: pokemonApi.reducer,\n  },\n  // Adding the api middleware enables caching, invalidation, polling,\n  // and other useful features of `rtk-query`.\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware().concat(pokemonApi.middleware),\n})\n\n// optional, but required for refetchOnFocus/refetchOnReconnect behaviors\n// see `setupListeners` docs - takes an optional callback as the 2nd arg for customization\nsetupListeners(store.dispatch)\n")),(0,i.kt)("h3",{id:"use-hooks-in-components"},"Use Hooks in Components"),(0,i.kt)("p",null,"Finally, import the auto-generated React hooks from the API slice into your component file, and call the hooks in your component with any needed parameters. RTK Query will automatically fetch data on mount, re-fetch when parameters change, provide ",(0,i.kt)("inlineCode",{parentName:"p"},"{data, isFetching}")," values in the result, and re-render the component as those values change:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import * as React from 'react'\nimport { useGetPokemonByNameQuery } from './services/pokemon'\n\nexport default function App() {\n  // Using a query hook automatically fetches data and returns query values\n  const { data, error, isLoading } = useGetPokemonByNameQuery('bulbasaur')\n  // Individual hooks are also accessible under the generated endpoints:\n  // const { data, error, isLoading } = pokemonApi.endpoints.getPokemonByName.useQuery('bulbasaur')\n\n  // render UI based on data and loading state\n}\n")),(0,i.kt)("h2",{id:"further-information"},"Further Information"),(0,i.kt)("p",null,"See the ",(0,i.kt)("a",{parentName:"p",href:"/tutorials/rtk-query/"},(0,i.kt)("strong",{parentName:"a"},"RTK Query Quick Start tutorial")),' for examples of how to add RTK Query to a project that uses Redux Toolkit, set up an "API slice" with endpoint definitions, and how to use the auto-generated React hooks in your components.'),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/queries"},(0,i.kt)("strong",{parentName:"a"},"RTK Query usage guide section"))," has information on topics like ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/queries"},"querying data"),", ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/mutations"},"using mutations to send updates to the server"),", ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/streaming-updates"},"streaming cache updates"),", and much more."),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/examples"},(0,i.kt)("strong",{parentName:"a"},"Examples page"))," has runnable CodeSandboxes that demonstrate topics like ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/examples#react-with-graphql"},"making queries with GraphQL"),", ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/examples#authentication"},"authentication"),", and even ",(0,i.kt)("a",{parentName:"p",href:"/rtk-query/usage/examples#svelte"},"using RTK Query with other UI libraries like Svelte"),"."))}h.isMDXComponent=!0},5318:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return h}});var n=a(7378);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=u(a),h=r,m=c["".concat(l,".").concat(h)]||c[h]||p[h]||i;return a?n.createElement(m,o(o({ref:t},d),{},{components:a})):n.createElement(m,o({ref:t},d))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var u=2;u<i;u++)o[u]=a[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"}}]);